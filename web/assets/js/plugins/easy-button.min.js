(function(){L.Control.EasyBar=L.Control.extend({options:{position:'topleft',id:null,leafletClasses:true},initialize:function(buttons,options){if(options){L.Util.setOptions(this,options);}
this._buildContainer();this._buttons=[];for(var i=0;i<buttons.length;i++){buttons[i]._bar=this;buttons[i]._container=buttons[i].button;this._buttons.push(buttons[i]);this.container.appendChild(buttons[i].button);}},_buildContainer:function(){this._container=this.container=L.DomUtil.create('div','');this.options.leafletClasses&&L.DomUtil.addClass(this.container,'leaflet-bar easy-button-container leaflet-control');this.options.id&&(this.container.id=this.options.id);},enable:function(){L.DomUtil.addClass(this.container,'enabled');L.DomUtil.removeClass(this.container,'disabled');this.container.setAttribute('aria-hidden','false');return this;},disable:function(){L.DomUtil.addClass(this.container,'disabled');L.DomUtil.removeClass(this.container,'enabled');this.container.setAttribute('aria-hidden','true');return this;},onAdd:function(){return this.container;},addTo:function(map){this._map=map;for(var i=0;i<this._buttons.length;i++){this._buttons[i]._map=map;}
var container=this._container=this.onAdd(map),pos=this.getPosition(),corner=map._controlCorners[pos];L.DomUtil.addClass(container,'leaflet-control');if(pos.indexOf('bottom')!==-1){corner.insertBefore(container,corner.firstChild);}else{corner.appendChild(container);}
return this;}});L.easyBar=function(){var args=[L.Control.EasyBar];for(var i=0;i<arguments.length;i++){args.push(arguments[i]);}
return new(Function.prototype.bind.apply(L.Control.EasyBar,args));};L.Control.EasyButton=L.Control.extend({options:{position:'topleft',id:null,type:'replace',states:[],leafletClasses:true,tagName:'button',},initialize:function(icon,onClick,title,id){this.options.states=[];if(id!=null){this.options.id=id;}
this.storage={};if(typeof arguments[arguments.length-1]==='object'){L.Util.setOptions(this,arguments[arguments.length-1]);}
if(this.options.states.length===0&&typeof icon==='string'&&typeof onClick==='function'){this.options.states.push({icon:icon,onClick:onClick,title:typeof title==='string'?title:''});}
this._states=[];for(var i=0;i<this.options.states.length;i++){this._states.push(new State(this.options.states[i],this));}
this._buildButton();this._activateState(this._states[0]);},_buildButton:function(){this.button=L.DomUtil.create(this.options.tagName,'');if(this.options.tagName==='button'){this.button.setAttribute('type','button');}
if(this.options.id){this.button.id=this.options.id;}
if(this.options.leafletClasses){L.DomUtil.addClass(this.button,'easy-button-button leaflet-bar-part leaflet-interactive');}
L.DomEvent.addListener(this.button,'dblclick',L.DomEvent.stop);L.DomEvent.addListener(this.button,'mousedown',L.DomEvent.stop);L.DomEvent.addListener(this.button,'mouseup',L.DomEvent.stop);L.DomEvent.addListener(this.button,'click',function(e){L.DomEvent.stop(e);this._currentState.onClick(this,this._map?this._map:null);this._map&&this._map.getContainer().focus();},this);if(this.options.type=='replace'){this.button.appendChild(this._currentState.icon);}else{for(var i=0;i<this._states.length;i++){this.button.appendChild(this._states[i].icon);}}},_currentState:{stateName:'unnamed',icon:(function(){return document.createElement('span');})()},_states:null,state:function(newState){if(arguments.length===0){return this._currentState.stateName;}
if(typeof newState=='string'){this._activateStateNamed(newState);}else if(typeof newState=='number'){this._activateState(this._states[newState]);}
return this;},_activateStateNamed:function(stateName){for(var i=0;i<this._states.length;i++){if(this._states[i].stateName==stateName){this._activateState(this._states[i]);}}},_activateState:function(newState){if(newState===this._currentState){return;}else{if(this.options.type=='replace'){this.button.appendChild(newState.icon);this.button.removeChild(this._currentState.icon);}
if(newState.title){this.button.title=newState.title;}else{this.button.removeAttribute('title');}
for(var i=0;i<this._states.length;i++){L.DomUtil.removeClass(this._states[i].icon,this._currentState.stateName+'-active');L.DomUtil.addClass(this._states[i].icon,newState.stateName+'-active');}
L.DomUtil.removeClass(this.button,this._currentState.stateName+'-active');L.DomUtil.addClass(this.button,newState.stateName+'-active');this._currentState=newState;}},enable:function(){L.DomUtil.addClass(this.button,'enabled');L.DomUtil.removeClass(this.button,'disabled');this.button.setAttribute('aria-hidden','false');return this;},disable:function(){L.DomUtil.addClass(this.button,'disabled');L.DomUtil.removeClass(this.button,'enabled');this.button.setAttribute('aria-hidden','true');return this;},onAdd:function(map){var bar=L.easyBar([this],{position:this.options.position,leafletClasses:this.options.leafletClasses});this._anonymousBar=bar;this._container=bar.container;return this._anonymousBar.container;},removeFrom:function(map){if(this._map===map)
this.remove();return this;},});L.easyButton=function(){var args=Array.prototype.concat.apply([L.Control.EasyButton],arguments);return new(Function.prototype.bind.apply(L.Control.EasyButton,args));};function State(template,easyButton){this.title=template.title;this.stateName=template.stateName?template.stateName:'unnamed-state';this.icon=L.DomUtil.create('span','');L.DomUtil.addClass(this.icon,'button-state state-'+this.stateName.replace(/(^\s*|\s*$)/g,''));this.icon.innerHTML=buildIcon(template.icon);this.onClick=L.Util.bind(template.onClick?template.onClick:function(){},easyButton);}
function buildIcon(ambiguousIconString){var tmpIcon;if(ambiguousIconString.match(/[&;=<>"']/)){tmpIcon=ambiguousIconString;}else{ambiguousIconString=ambiguousIconString.replace(/(^\s*|\s*$)/g,'');tmpIcon=L.DomUtil.create('span','');if(ambiguousIconString.indexOf('fa-')===0){L.DomUtil.addClass(tmpIcon,'fa '+ambiguousIconString)}else if(ambiguousIconString.indexOf('glyphicon-')===0){L.DomUtil.addClass(tmpIcon,'glyphicon '+ambiguousIconString)}else{L.DomUtil.addClass(tmpIcon,ambiguousIconString)}
tmpIcon=tmpIcon.outerHTML;}
return tmpIcon;}})();